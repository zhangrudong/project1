"use strict";var _createClass=function(){function i(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,s){return e&&i(t.prototype,e),s&&i(t,s),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Classify(){this.ali=document.querySelectorAll("nav .n-l .menu li"),this.menu=document.querySelector("nav .n-l .menu-r"),this.h6=document.querySelector("nav .n-l .menu-r h6"),this.nl=document.querySelector("nav .n-l"),this.init()}function Select(){var n=document.querySelector(".list"),o=n.children,a=document.querySelector("header .h-c-b .txt"),h=!0,r=0;a.onclick=function(t){if(function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(t||window.event),1==h){n.style.display="block";for(var e=0;e<o.length;e++)o[e].className="";o[r].className="active",h=!1}else n.style.display="none",h=!0},document.onclick=function(){n.style.display="none",h=!0};for(var t=0;t<o.length;t++)o[t].index=t,o[t].onmouseover=function(){r=this.index;for(var t=0;t<o.length;t++)o[t].className="";this.className="active"},o[t].onclick=function(){a.placeholder=this.innerHTML,r=this.index};document.onkeydown=function(t){if(1!=h){var e=t||window.event,s=e.keycode||e.which;if(38==s){0==r?r=0:r--;for(var i=0;i<o.length;i++)o[i].className="";o[r].className="active",a.placeholder=o[r].innerHTML}if(40==s){r==o.length-1?r=o.length-1:r++;for(i=0;i<o.length;i++)o[i].className="";o[r].className="active",a.placeholder=o[r].innerHTML}13==s&&(n.style.display="none",h=!0)}}}Classify.prototype.init=function(){for(var e=this,t=0;t<this.ali.length;t++)this.ali[t].setAttribute("hehe",t),this.ali[t].onmouseenter=function(){e.menu.style.display="block";var t=this.getAttribute("hehe");e.h6.innerHTML=e.ali[t].innerHTML},this.nl.onmouseleave=function(){e.menu.style.display="none"}},new Classify,Select();var Index=function(){function t(){_classCallCheck(this,t),this.p=document.querySelector("#top .div p"),this.span=document.querySelector("#top .div p span"),this.exit=document.querySelector("#top .div p #exit"),this.left=document.querySelector("#top .left"),this.getData(),this.addEvent()}return _createClass(t,[{key:"getData",value:function(){this.date=localStorage.getItem("date"),null==this.date?this.date=[]:this.date=JSON.parse(this.date),this.panduan()}},{key:"panduan",value:function(){for(var t=0;t<this.date.length;t++)if(1==this.date[t].onoff)return this.left.style.display="none",this.p.style.display="block",this.span.innerHTML=this.date[t].tel,void(this.successUser=this.date[t].tel);this.left.style.display="block",this.p.style.display="none",this.span.innerHTML=""}},{key:"addEvent",value:function(){var e=this;this.exit.onclick=function(){if(e.successUser)for(var t=0;t<e.date.length;t++)e.date[t].tel===e.successUser&&(e.date[t].onoff=0,localStorage.setItem("date",JSON.stringify(e.date)),e.panduan())}}}]),t}();new Index;var shop=function(){function t(){_classCallCheck(this,t),this.getData()}return _createClass(t,[{key:"getData",value:function(){this.date=localStorage.getItem("date"),null==this.date?this.date=[]:this.date=JSON.parse(this.date),this.panduan()}},{key:"panduan",value:function(){for(var t=0;t<this.date.length;t++)if(1==this.date[t].onoff)return;location.href="login.html"}}]),t}();function Tab(){this.li=document.querySelectorAll("#t-nav li"),this.cont=document.querySelectorAll(".shop #cont"),this.cont2=document.querySelector(".shop #cont2"),this.index=0,this.init()}function Goods(){this.cont=document.querySelector(".shop #cont"),this.url="http://localhost:5555/date/shop.json",this.li=document.querySelectorAll(".shop #cont li"),this.span=document.querySelector(".h-r .h-r-r span"),this.init(),this.addEvent()}function addEvent(t,e,s){t.addEventListener?t.addEventListener(e,s,!1):t.attachEvent?t.attachEvent("on"+e,s):t["on"+e]=s}function Goodss(){this.cont=document.querySelector(".list ul"),this.url="http://localhost:5555/date/shop.json",this.li=document.querySelectorAll(".list ul li"),console.log(this.cont),this.init(),this.addEvent()}function addEvent(t,e,s){t.addEventListener?t.addEventListener(e,s,!1):t.attachEvent?t.attachEvent("on"+e,s):t["on"+e]=s}new shop,Tab.prototype.init=function(){for(var t=this,e=0;e<this.li.length;e++)this.li[e].xuhao=e,this.li[e].onclick=function(){t.changeIndex(this)}},Tab.prototype.changeIndex=function(t){this.index=t.xuhao,this.hide()},Tab.prototype.hide=function(){for(var t=0;t<this.li.length;t++)this.li[t].className="";this.show()},Tab.prototype.show=function(){this.li[this.index].className="te"},new Tab,Goods.prototype.init=function(){var e=this;ajaxGet(this.url).then(function(t){e.res=JSON.parse(t),e.display()})},Goods.prototype.display=function(){for(var t="",e=0;e<this.res.length;e++)t+='\n        <li index="'+this.res[e].id+'">\n                    <a  href="'+this.res[e].src+'">\n                    <img src="'+this.res[e].url+'">\n                    <span>'+this.res[e].price+"</span>\n                    <p>"+this.res[e].name+'</p></a>\n                    <em class="add">加入购物车</em>\n                </li>';this.cont.innerHTML=t},Goods.prototype.addEvent=function(){var i=this;addEvent(this.cont,"click",function(t){var e=t||window.event,s=e.target||e.srcElement;"add"==s.className&&(i.id=s.parentNode.getAttribute("index"),i.setCookie())})},Goods.prototype.setCookie=function(){if(this.goods=getCookie("goods"),""==this.goods)this.goods=[{id:this.id,num:1}];else{var t=!0;this.goods=JSON.parse(this.goods);for(var e=0;e<this.goods.length;e++)if(this.goods[e].id==this.id){this.goods[e].num++,t=!1;break}t&&this.goods.push({id:this.id,num:1})}setCookie("goods",JSON.stringify(this.goods))},new Goods,Goodss.prototype.init=function(){var e=this;ajaxGet(this.url).then(function(t){e.res=JSON.parse(t),e.display()})},Goodss.prototype.display=function(){for(var t="",e=0;e<this.res.length;e++)t+='\n        <li index="'+this.res[e].id+'">\n                    <a href="'+this.res[e].src+'">\n                    <img src="'+this.res[e].url+'">\n                    <span>'+this.res[e].price+"</span>\n                    <p>"+this.res[e].name+'</p></a>\n                    <em class="add">加入购物车</em>\n                </li>';this.cont.innerHTML=t},Goodss.prototype.addEvent=function(){var i=this;addEvent(this.cont,"click",function(t){var e=t||window.event,s=e.target||e.srcElement;"add"==s.className&&(i.id=s.parentNode.getAttribute("index"),i.setCookie())})},Goodss.prototype.setCookie=function(){if(this.goods=getCookie("goods"),""==this.goods)this.goods=[{id:this.id,num:1}];else{var t=!0;this.goods=JSON.parse(this.goods);for(var e=0;e<this.goods.length;e++)if(this.goods[e].id==this.id){this.goods[e].num++,t=!1;break}t&&this.goods.push({id:this.id,num:1})}setCookie("goods",JSON.stringify(this.goods))},new Goodss;var Login=function(){function t(){_classCallCheck(this,t),this.tel=$("#tel"),this.pass=$("#pass"),this.apass=$("#apass"),this.sub=$("#sub"),this.span=$("#span"),this.aspan=$(".write span"),this.radio=$("#radio"),this.init(),this.getData()}return _createClass(t,[{key:"init",value:function(){var t=this;this.sub.click(function(){""!=t.tel.val()&&""!=t.pass.val()?t.Proving():t.aspan.eq(0).html("请输入正确的手机号")}),this.tel.blur(function(){/^1[3-9]\d{9}$/.test(t.tel.val())?t.aspan.eq(0).html(""):t.aspan.eq(0).html("手机号有误，请重新输入！")}),this.pass.blur(function(){/^.{6,18}$/.test(t.pass.val())?t.aspan.eq(1).html(""):t.aspan.eq(1).html("密码错误！")})}},{key:"getData",value:function(){this.date=localStorage.getItem("date"),null==this.date?this.date=[]:this.date=JSON.parse(this.date)}},{key:"Proving",value:function(){for(var t=0;t<this.date.length;t++)if(this.date[t].tel==this.tel.val()&&this.date[t].pass==this.pass.val())return alert("登录成功,点击跳转到首页"),this.date[t].onoff=1,localStorage.setItem("date",JSON.stringify(this.date)),void setTimeout(function(){location.href="index.html"},0);this.aspan.eq(0).html("用户名密码不符")}}]),t}();new Login;var register=function(){function t(){_classCallCheck(this,t),this.tel=$("#tel"),this.pass=$("#pass"),this.apass=$("#apass"),this.sub=$("#sub"),this.span=$("#span"),this.aspan=$(".write span"),this.radio=$("#radio"),this.init(),this.getData()}return _createClass(t,[{key:"init",value:function(){var t=this;this.radio.click(function(){t.sub.css("background","rgb(255, 115, 0)"),t.sub.click(function(){t.setData()})}),this.tel.blur(function(){/^1[3-9]\d{9}$/.test(t.tel.val())?t.aspan.eq(0).html(""):t.aspan.eq(0).html("请输入正确的手机号")}),this.pass.blur(function(){/^.{6,18}$/.test(t.pass.val())?t.aspan.eq(1).html(""):t.aspan.eq(1).html("密码长度不符")}),this.apass.blur(function(){""!=t.apass.val()&&(t.apass.val()==t.pass.val()?t.aspan.eq(2).html(""):t.aspan.eq(2).html("密码不一致"))})}},{key:"getData",value:function(){this.date=localStorage.getItem("date"),null==this.date?this.date=[]:this.date=JSON.parse(this.date)}},{key:"setData",value:function(){if(0==this.date.length)this.date.push({tel:this.tel.val(),pass:this.pass.val(),onoff:0}),alert("注册成功，点击立即跳转到登录页面！"),location.href="login.html",localStorage.setItem("date",JSON.stringify(this.date));else{for(var t=0;t<this.date.length;t++)if(this.date[t].tel===this.tel.val())return void this.aspan.eq(3).html("已经被注册了，重新换个吧！");this.date.push({tel:this.tel.val(),pass:this.pass.val(),onoff:0}),alert("注册成功，点击立即跳转到登录页面！"),location.href="login.html",localStorage.setItem("date",JSON.stringify(this.date))}}}]),t}();function Magnifier(){this.sBox=document.querySelector(".s-l .simg"),this.sImg=document.querySelector(".s-l .simg img"),this.span=document.querySelector(".s-l .simg span"),this.bBox=document.querySelector(".s-l .bimg"),this.list=document.querySelectorAll(".s-l .s-b ul li"),this.bImg=document.querySelector(".s-l .bimg img"),this.index=0,this.init()}function Car(){this.tbody=document.querySelector(" .car tbody"),this.url="http://localhost:5555/date/shop.json",this.span=document.querySelector(".h-r .h-r-r span"),this.oa=document.querySelector(".car a"),this.thead=document.querySelector(" .car thead"),this.init(),this.addEvent()}function addEvent(t,e,s){t.addEventListener?t.addEventListener(e,s,!1):t.attachEvent?t.attachEvent("on"+e,s):t["on"+e]=s}function removeEvent(t,e,s){t.removeEventListener?t.removeEventListener(e,s,!1):t.detachEvent?t.detachEvent("on"+e,s):t["on"+e]=null}new register,Magnifier.prototype.show=function(){this.span.style.display="block",this.bBox.style.display="block"},Magnifier.prototype.hide=function(){this.span.style.display="none",this.bBox.style.display="none"},Magnifier.prototype.move=function(t){var e=t.x-1.6*this.span.offsetWidth,s=t.y-2.1*this.span.offsetHeight;e<0&&(e=0),s<0&&(s=0),e>this.sBox.offsetWidth-this.span.offsetWidth&&(e=this.sBox.offsetWidth-this.span.offsetWidth),s>this.sBox.offsetHeight-this.span.offsetHeight&&(s=this.sBox.offsetHeight-this.span.offsetHeight),this.span.style.left=e+"px",this.span.style.top=s+"px";var i=e/(this.sBox.offsetWidth-this.span.offsetWidth),n=s/(this.sBox.offsetHeight-this.span.offsetHeight);this.bImg.style.left=-i*(this.bImg.offsetWidth-this.bBox.offsetWidth)+"px",this.bImg.style.top=-n*(this.bImg.offsetHeight-this.bBox.offsetHeight)+"px"},Magnifier.prototype.init=function(){var s=this;this.sBox.onmouseover=function(){s.show(),s.sBox,this.onmousemove=function(t){var e=t||window.event;s.move({x:e.pageX-this.offsetLeft,y:e.pageY-this.offsetTop})}},this.sBox.onmouseout=function(){s.hide()}},new Magnifier,Car.prototype.init=function(){var e=this;ajaxGet(this.url).then(function(t){e.res=JSON.parse(t),e.getCookie()})},Car.prototype.getCookie=function(){this.goods=""!=getCookie("goods")?JSON.parse(getCookie("goods")):[],"[]"!=getCookie("goods")?(this.display(),this.oa.innerHTML=""):this.thead.innerHTML=""},Car.prototype.display=function(){for(var t="",e=0;e<this.res.length;e++)for(var s=0;s<this.goods.length;s++)this.res[e].id==this.goods[s].id&&(t+='<tr index="'+this.res[e].id+'">\n                            <td><img src="'+this.res[e].url+'"/></td>\n                            <td>'+this.res[e].name+"</td>\n                            <td>"+this.res[e].price+'</td>\n                            <td><input type="number" min=1 value="'+this.goods[s].num+'" class="num"></td>\n                            <td ><em class="dele">删除</em></td>\n                        </tr> ');this.tbody.innerHTML=t,this.span.innerHTML=this.goods.length},Car.prototype.addEvent=function(){var i=this;addEvent(this.tbody,"input",function(t){var e=t||window.eve,s=e.target||e.srcElement;"num"==s.className&&(i.num=s.value,i.id=s.parentNode.parentNode.getAttribute("index"),i.changeCookie(function(t){i.goods[t].num=i.num}))}),this.tbody.addEventListener("click",function(t){var e=t||window.event,s=e.target||e.srcElement;"dele"==s.className&&(i.id=s.parentNode.parentNode.getAttribute("index"),s.parentNode.parentNode.remove(),i.changeCookie(function(t){i.goods.splice(t,1)}))})},Car.prototype.changeCookie=function(t){for(var e=0;e<this.goods.length;e++)this.goods[e].id==this.id&&t(e);setCookie("goods",JSON.stringify(this.goods))},new Car;